<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Etiquetas de Garantia</title>
  <style>
    :root {
      --azul: #141b4d;
      --laranja: #ff7a15;
    }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: var(--azul);
      color: var(--azul);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 40px 20px;
    }

    h1 {
      color: white;
      margin-bottom: 20px;
    }

    form {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 600px;
      width: 100%;
    }

    label {
      font-weight: bold;
      margin-top: 10px;
    }

    input, textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin-top: 4px;
    }

    button {
      background-color: var(--laranja);
      color: white;
      border: none;
      padding: 10px 20px;
      margin-right: 10px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover {
      background-color: #e46b0e;
    }

    .etiqueta {
      background: white;
      border: 1px solid #ccc;
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      color: black;
      max-width: 600px;
    }

    .etiqueta .logo {
      width: 100px;
      margin-bottom: 10px;
    }

    .etiqueta button {
      background-color: transparent;
      color: var(--laranja);
      border: 1px solid var(--laranja);
      margin-top: 10px;
    }

    .etiqueta button:hover {
      background-color: var(--laranja);
      color: white;
    }

    #listaEtiquetas {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    @media print {
      button, form { display: none; }
      body {
        background: white;
        color: black;
        padding: 0;
      }
      .etiqueta {
        page-break-inside: avoid;
        border: 1px solid #000;
        padding: 12px;
        margin-bottom: 15px;
      }
      .etiqueta button {
        display: none;
      }
      .etiqueta .logo {
        display: block;
      }
    }
  </style>
</head>
<body>

  <h1>Etiquetas de Garantia</h1>

  <form id="formulario">
    <label for="codigo">Código do Produto:</label>
    <input type="text" id="codigo" required>

    <label for="descricao">Descrição:</label>
    <input type="text" id="descricao" readonly>

    <label for="quantidade">Quantidade:</label>
    <input type="number" id="quantidade" min="1" required>

    <label for="causa">Causa da Garantia:</label>
    <textarea id="causa" required></textarea>

    <button type="button" onclick="incluirProduto()">Incluir Produto</button>
    <button type="button" onclick="imprimirEtiquetas()">Imprimir</button>
  </form>

  <div id="listaEtiquetas"></div>

  <script>
    const produtos = [];

    const planilhaURL = 'https://script.google.com/macros/s/1xJQ_C52GGWuCpnNCDmwJFdLhO4vCQeuBxKRnkiJH-mw/exec';

    document.getElementById('codigo').addEventListener('blur', async function() {
      const codigo = this.value;
      const response = await fetch(`${planilhaURL}?codigo=${codigo}`);
      const data = await response.json();
      document.getElementById('descricao').value = data.descricao || 'Produto não encontrado';
    });

    function incluirProduto() {
      const codigo = document.getElementById('codigo').value;
      const descricao = document.getElementById('descricao').value;
      const quantidade = document.getElementById('quantidade').value;
      const causa = document.getElementById('causa').value;
      const dataHora = new Date().toLocaleString();

      if (!codigo || !quantidade || !causa || descricao === 'Produto não encontrado') return;

      produtos.push({ codigo, descricao, quantidade, causa, dataHora });
      renderizarEtiquetas();

      document.getElementById('formulario').reset();
      document.getElementById('descricao').value = '';
    }

    function excluirProduto(index) {
      produtos.splice(index, 1);
      renderizarEtiquetas();
    }

    function renderizarEtiquetas() {
      const container = document.getElementById('listaEtiquetas');
      container.innerHTML = '';
      produtos.forEach((item, index) => {
        container.innerHTML += `
          <div class="etiqueta">
            <img src="Logo Rezende Branca.png" alt="Logo Rezende" class="logo">
            <strong>Data/Hora:</strong> ${item.dataHora}<br>
            <strong>Código:</strong> ${item.codigo}<br>
            <strong>Descrição:</strong> ${item.descricao}<br>
            <strong>Quantidade:</strong> ${item.quantidade}<br>
            <strong>Causa:</strong> ${item.causa}<br>
            <button onclick="excluirProduto(${index})">Excluir</button>
          </div>
        `;
      });
    }

    function imprimirEtiquetas() {
      if (produtos.length === 0) return;
      window.print();
      produtos.length = 0;
      renderizarEtiquetas();
    }
  </script>

</body>
</html>
